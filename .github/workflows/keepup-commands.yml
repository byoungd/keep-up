name: keepup-commands

on:
  issue_comment:
    types: [created]

permissions:
  issues: write
  pull-requests: write

jobs:
  keepup-commands:
    if: |
      github.event.issue.pull_request &&
      (contains(github.event.comment.body, '/review') || contains(github.event.comment.body, '/explain'))
    runs-on: ubuntu-latest
    steps:
      - name: Acknowledge command
        uses: actions/github-script@v7
        with:
          script: |
            const body = context.payload.comment.body || "";
            const commands = [];
            if (body.includes("/review")) commands.push("/review");
            if (body.includes("/explain")) commands.push("/explain");
            const message = [
              `KeepUp command received: ${commands.join(", ")}.`,
              "Phase 11 runs a lightweight workflow only; full automation ships in Phase 12.",
            ].join("\n\n");
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.payload.issue.number,
              body: message,
            });
