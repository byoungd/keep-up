# Phase 6 Baseline Benchmarks

Date: 2026-01-24
Owner: Agent Runtime Team
Status: Captured

## Commands
- pnpm perf:baseline
- pnpm perf:metrics
- pnpm bench:cache (invoked by perf:baseline)

## Metrics

| Metric | Baseline | Target | Notes |
| --- | --- | --- | --- |
| Sandbox startup | 2.84ms (P99) | <10ms | sandbox-rs createSandbox + manager init, 50 iters |
| Event log P99 | 4.97ms | <5ms | NativeTaskGraphEventLog append, 1000 iters |
| Checkpoint save | 8.08ms (P99) | <5ms | RustCheckpointStorage save, 100 iters |
| Checkpoint load | 0.01ms (P99, warm cache) | <5ms | RustCheckpointStorage load, 100 iters |
| Token counting | 13.60ms / 10k tokens (avg) | <1ms / 10k tokens | Native tokenizer binding, 200 iters |
| Diff patch | 31.32ms (P99) | <5ms | createTwoFilesPatch, 2k lines, 200 iters |
| Symbol query | 91.03ms (P99) | <5ms | Native symbol index, 10k symbols, 500 iters |
| Spooler memory | 2.39MB heap / 1.54MB RSS (P99) | TBD | File spooler write, ~512KB payload |

## Captured Artifacts

- artifacts/perf-baseline.json (cache bench results)
- artifacts/perf-metrics.json (Phase 6 baseline metrics)

## Notes
- Capture baselines before switching hot paths to Rust.
- Attach perf artifacts under `artifacts/` if generated by scripts.
- Spooler memory reports before/after deltas per run (not true peak RSS).
- Perf metrics can vary with system load; compare multiple runs when evaluating regressions.
- Checkpoint load now uses an in-memory cache (warm cache numbers above); cold-load latency still needs characterization.
